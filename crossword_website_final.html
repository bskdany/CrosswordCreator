<!--    /$$$$$$                                                                                 /$$  -->
<!--   /$$__  $$                                                                               | $$  -->
<!--  | $$  \__/  /$$$$$$   /$$$$$$   /$$$$$$$ /$$$$$$$ /$$  /$$  /$$  /$$$$$$   /$$$$$$   /$$$$$$$  -->
<!--  | $$       /$$__  $$ /$$__  $$ /$$_____//$$_____/| $$ | $$ | $$ /$$__  $$ /$$__  $$ /$$__  $$  -->
<!--  | $$      | $$  \__/| $$  \ $$|  $$$$$$|  $$$$$$ | $$ | $$ | $$| $$  \ $$| $$  \__/| $$  | $$  -->
<!--  | $$    $$| $$      | $$  | $$ \____  $$\____  $$| $$ | $$ | $$| $$  | $$| $$      | $$  | $$  -->
<!--  |  $$$$$$/| $$      |  $$$$$$/ /$$$$$$$//$$$$$$$/|  $$$$$/$$$$/|  $$$$$$/| $$      |  $$$$$$$  -->
<!--   \______/ |__/       \______/ |_______/|_______/  \_____/\___/  \______/ |__/       \_______/  -->
<!--                                                                                                 -->                                                                                                                                                                       
<!--    /$$$$$$                                  /$$                                                 -->
<!--   /$$__  $$                                | $$                                                 -->
<!--  | $$  \__/  /$$$$$$   /$$$$$$   /$$$$$$  /$$$$$$    /$$$$$$   /$$$$$$                          -->
<!--  | $$       /$$__  $$ /$$__  $$ |____  $$|_  $$_/   /$$__  $$ /$$__  $$                         -->
<!--  | $$      | $$  \__/| $$$$$$$$  /$$$$$$$  | $$    | $$  \ $$| $$  \__/                         -->
<!--  | $$    $$| $$      | $$_____/ /$$__  $$  | $$ /$$| $$  | $$| $$                               -->
<!--  |  $$$$$$/| $$      |  $$$$$$$|  $$$$$$$  |  $$$$/|  $$$$$$/| $$                               -->
<!--   \______/ |__/       \_______/ \_______/   \___/   \______/ |__/                               -->
                                                                                             
   
<!--    This project was created by https://github.com/bskdany/      -->


<html >

    <head>
        <meta charset="utf-8">
        <script src="https://cdn.jsdelivr.net/npm/brython@3.8.9/brython.min.js">
        </script>
        <script src="https://cdn.jsdelivr.net/npm/brython@3.8.9/brython_stdlib.js">
        </script>
    </head>
    
    <div class="header">
        <div class='headerText'>Crossword Creator</div>
        <div class= 'subtitleText'>A simple tool to create a crossword with user given words</div>
        <div class='logo'></div>
    </div>

    <hr style="width:80%", size="2", color=white> 

    <body onload="brython()" class='main'>

        <center><div class='container' >
            
            <div class='numbers' >
                <div>&nbsp;</div>
                <div>&nbsp;</div>
                <div>1</div>
                <div>2</div>
                <div>3</div>
                <div>4</div>
                <div>5</div>
                <div>6</div>
                <div>7</div>
                <div>8</div>
                <div>9</div>
                <div>10</div>
                <div>11</div>
                <div>12</div>
                <div>13</div>
                <div>14</div>
                <div>15</div>
                <div>16</div>
                <div>17</div>
                <div>18</div>
                <div>19</div>
                <div>20</div>
            </div>

            <div class = 'inpt'>
                <center><h1>Words input</h1></center>
                <input id = 'word1' ><br>
                <input id = 'word2' ><br>
                <input id = 'word3' ><br>
                <input id = 'word4' ><br>
                <input id = 'word5' ><br>
                <input id = 'word6' ><br>
                <input id = 'word7' ><br>
                <input id = 'word8' ><br>
                <input id = 'word9' ><br>
                <input id = 'word10' ><br>
                <input id = 'word11' ><br>
                <input id = 'word12' ><br>
                <input id = 'word13' ><br>
                <input id = 'word14' ><br>
                <input id = 'word15' ><br>
                <input id = 'word16' ><br>
                <input id = 'word17' ><br>
                <input id = 'word18' ><br>
                <input id = 'word19' ><br>
                <input id = 'word20' ><br>
            </div>

            <div class='inpt2'>
                <center><h1>Words definition</h1></center>
                <input id = 'word1def' ><br>
                <input id = 'word2def' ><br>
                <input id = 'word3def' ><br>
                <input id = 'word4def' ><br>
                <input id = 'word5def' ><br>
                <input id = 'word6def' ><br>
                <input id = 'word7def' ><br>
                <input id = 'word8def' ><br>
                <input id = 'word9def' ><br>
                <input id = 'word10def' ><br>
                <input id = 'word11def' ><br>
                <input id = 'word12def' ><br>
                <input id = 'word13def' ><br>
                <input id = 'word14def' ><br>
                <input id = 'word15def' ><br>
                <input id = 'word16def' ><br>
                <input id = 'word17def' ><br>
                <input id = 'word18def' ><br>
                <input id = 'word19def' ><br>
                <input id = 'word20def' ><br>
            </div>
            
            <div class='user_manual'>
                <h1>How to use:</h1>
                <div>Place the words you want to make a crossword with in the words input field,
                    then write a definition for those words in the words definition field, if the
                    cell is blank the definition will be equal to the word.<br>
                    The Crossword size option defines how big the crossword is, the size is the lenght
                    of each side of the crossword, if left blank it will use the value of 10.<br>
                    The how many crosswords option defines how many crosswords you want to create with the 
                    given words, if left blank it will create only one crossword.<br>
                    The show words tick auto-completes the crossword.<br> 
                    The time for the algorythm to run depends on many factors, like how many words you use and so on.<br>
                    If two words are the same, if there is an empty cell between two input fields
                    or if there is no way to place a word in the crossword the program won't work correctly.<br>
                   
                </div>
            </div>

            <div class='options' >
                <div  style='float: left;'>Options:</div>
                <div style='float: left;'>Crossword size :<input id = 'size' maxlength="2" size='2'> </div>
                <div style='float:left'>How many crosswords : <input id = 'how_many_crosswords' maxlength="2" size='2'> </div>
                <div  style='float: left; margin-left: 1px;' >Randomize crossword: <input  type="checkbox" id="random_tick" ></div>
                <button style='float: left;width:100px;height:30px;'  id="submit">submit</button><div  style='float: left; margin-left: 10px;' >Show words: <input  type="checkbox" id="show_words" checked></div>
                
            </div>   
                 
        </div></center>

        <center><div class='alert'>
            <div class = 'error' id = 'error_msg' ></div>
            <div class = 'error' id = 'error_msg_/' ></div>
            <div class = 'error' id = 'error_msg_$' ></div>
            <div class = 'error' id = 'error_msg_dup' ></div>
        </div></center>
        
        <div class = 'cycle'><center>
            <div>Cycle between crosswords</div>
            <button id="previous">&#60; </button>
            <button id="next">	&#62;</button>
        </center></div>

        <center><div id='zone'> </div></center>
        
        <center><div class='words_definitions'>
            <div class='vrt_text'>Vertical</div>
            <div class='hrz_text'>Horizzontal</div>
            <div id = 'vrt' class='vrt_def'></div>
            <div id = 'hrz' class='hrz_def'></div>
        </div></center> 

        <div style="width: 100%;height: 400px;"></div>

    </body>
    <hr style="width:80%", size="2", color=white>
    <footer style='width: 100%;height: 50px;color: #eeeeee;font-size: medium;text-align: center;'>
        <center>Made with ❤️by <a href="https://github.com/bskdany" target="_blank" style='color: rgb(28, 120, 136);'>bskdany</a></center>
    </footer>

    <style>
        .main{
            background-color: #2e2d33;
        }

        *{
            font-family: sans-serif;
            font-weight: normal;
            font-size: 1.1em;
        }

        table{
            background-color: rgb(255, 253, 253);
            text-align: center;
            empty-cells: hide;
        }

        .header {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            grid-template-rows: auto auto;
            grid-template-areas: 
                'x y .'
                'x z .';
            width: 100%;
            background-color: #2e2d33;
            top: 0;
            margin: 0;
            height:150px;
            white-space: nowrap;   
        }
        
        .logo{
            grid-area: x;
            margin-left: 5px; 
            top: 0;
            background: url("https://i.ibb.co/Vvwkr5G/logo2.png") no-repeat;
            width: 142px;
            height: 150px;
            float: left;
            border: 0;
        }

        .headerText{
            grid-area: y;
            color: #eeeeee;
            font-family: 'Trebuchet MS', sans-serif;
            font-size: 380%;
            text-align: center;
        }

        .subtitleText{
            grid-area: z;
            color: #eeeeee;
            font-family: 'Trebuchet MS', sans-serif;
            font-size: 100%;
            text-align: center;
        }

        .numbers{
            display: grid;
            row-gap: 1fr;
            grid-area: a;
        }

        .inpt{
            grid-area: b;
        }

        .inpt2{
            grid-area: c;
            margin-left: 5px;
            width: min-content ;
        }

        .options{
            grid-area: d;
            font-size: smaller;
            white-space: nowrap;
            height: min-content;
            width: min-content;
            align-items: flex-end;
            border: 1px solid black; 
            padding: 3px;
            line-height: 1.4;
            margin-bottom: 0px;
            margin-top: 30px;
        }

        .cycle{
            margin-top: 10px;
            margin-bottom: 10px;
            font-size: smaller;
            color: #eeeeee;   
        }

        .vrt_text{
            grid-area: aa;
            border: 1px solid black; 
            padding: 10px;
        }

        .hrz_text{
            grid-area: ab;
            border: 1px solid black; 
            padding: 10px;
        }

        .vrt_def{
            grid-area: ac;
            border: 1px solid black; 
            padding: 10px;
            text-align: left;
        }

        .hrz_def{
            grid-area: ad;
            border: 1px solid black; 
            padding: 10px;
            text-align: left;
        }

        .words_definitions{
            display: grid;
            grid-template-columns:1fr 1fr;
            grid-template-rows: min-content 80%;
            grid-template-areas: 
                'aa ab'
                'ac ad'; 
            margin-top: 20px;
            margin-left: 20%;
            margin-right: 20%;
            color: #eeeeee;
        }   

        .user_manual{
            grid-area: e;
            text-align: left;
            font-size: medium;
            border: 1px solid black; 
            padding: 10px;
            line-height: 1.3;
            
        }

        .container {
            display: grid;
            grid-template-columns: min-content min-content  min-content 1fr ;
            grid-template-areas: 
                'a b c e'
                'a b c d';
            grid-template-rows: auto auto;
            margin-top: 70px;
            width: min-content;
            border: 1px solid black; 
            padding: 10px;
            column-gap: 10px;     
            color: #eeeeee;   
        }

        .alert{
            color: #eeeeee;
            margin-top: 5px;
            font-size: medium;
        }

        </style>

        

    <script type="text/python">

        from browser import document,  timer
        from browser.html import TABLE, TR, TH, TD
        import html
        import itertools
        import math
        import random

        #function that creates "the bone structure" of the crosswords
        #it returns an array of arrays, the first array is an array 
        #of lenght crossword_size*crossword_size, so it's like an 
        #empty crossword
        def new_array():
            default_array =["/"] * crossword_size*crossword_size   
            temp_array = [[] for _ in range(30)] # creates a base for all the crosswords 
            temp_array[0].append(default_array) # the first empty crossword is placed in the first place of temp_array
            return temp_array

        #function that prints the finished array on the website 
        #in a crossword form
        def print_array_site(array): 

            global show_words_var 
            coords = array[1]  #array is divided in crossword and coordinates of the words
            array = array[0]    #that are placed inside of it
            array1 = array.copy()
            
            #placeholder symbols are removed from both arrays
            counter = 0
            while counter != len(array):                                
                if array[counter] == '/' or array[counter] == '$':     
                    array[counter] = ''
                counter = counter +1
                   

            counter = 0
            while counter != len(array1):
                if array1[counter] == '/' or array1[counter] == '$':
                    array1[counter] = ''
                counter = counter +1
            
            #crossword_size is calculated
            crossword_size = math.sqrt(len(array))  
            
            #adds a , between words indices if necessary
            for coord in coords:
                where = coord[1]

                if str(array1[where]).isnumeric():
                    array1[where] = str(array1[where]) +','+ str(coord[0])
                else:    
                    array1[where] = coord[0]

            #table is initialized
            t = TABLE(cellspacing='0',border="2px")
            x = 0
            while x < crossword_size:
                y = 0
                while y < crossword_size:

                    #if show words is true the cells are placed normally
                    if show_words_var == True:
                        t <= TD(array[x*crossword_size+y],style={'height':31, 'width':31})   

                    #if show words is False
                    else:
                        #if its a number it's placed top right of the cell
                        if str(array1[x*crossword_size+y]).isnumeric() or len(array1[x*crossword_size+y]) >1:
                            t <= TD(array1[x*crossword_size+y],style={'height':31, 'width':31,'font-size':'15px', 'vertical-align':'top', 'text-align':'left'}) 
                        
                        #if it's a letter it's placed with white font
                        else:                                
                            t <= TD(array1[x*crossword_size+y],style={'height':31, 'width':31,'color':'white'}) 
                    y = y+1  
               
                t <= TR()   
                x = x +1 
            
            #table is sent to html
            document['zone'].text = ''
            document['zone']<= t      

            #the words definitions are sent to be printed
            print_word_def_site(coords)

        #event that happens when the submit button is pressed   
        def submit(event):

            #global variables imported and initialized
            global end_crosswords
            global end_crosswords_counter
            global word_list
            global words_def
            global how_many_crosswords
            global crossword_size
            global words
            words_def = []
            end_crosswords = []
            end_crosswords_counter = 0
            
            ##if how_many_crosswords field is empty value is set to 1
            if document['how_many_crosswords'].value == '':
                how_many_crosswords = 1
            else:
                how_many_crosswords = document['how_many_crosswords'].value
                how_many_crosswords = int(how_many_crosswords)

            #if crossword_size field is empty value is set to 10
            if document['size'].value == '':
                crossword_size = 10
            else:
                crossword_size = document['size'].value
                crossword_size = int(crossword_size)
           
            #html fields cleared
            document["how_many_crosswords"].clear() 
            document["size"].clear()    
            document["error_msg"].clear()  
            document["error_msg_/"].clear()  
            document["error_msg_$"].clear()  
            document["error_msg_dup"].clear()

            #takes the words from the words input
            words = []
            counter = 1
            while counter != 21:
                id = 'word' + str(counter)
                word = document[id].value

                #exception
                if len(word) <= crossword_size:
                    bad_word = False
                    for letter in word:
                        
                        #searches for '/' and '$' inside the words because
                        #they are used as placeholders later 
                        if letter =='/' :

                            #if found an alert is prompted
                            msg = "Ops, you cannot place the '/' sign in the word "+word+" \n"
                            document["error_msg_/"] <= (f"{msg}")
                            bad_word = True

                        if letter =='$' :
                            msg = "Ops, you cannot place the '$' sign in the word "+word+" \n"
                            document["error_msg_$"] <= (f"{msg}")
                            bad_word = True

                    #if everything is ok word is appended   
                    if word != '' and bad_word == False:
                        words.append(document[id].value)
                
                #alert for word bigger than crossword_size
                else:
                    msg = "Ops, the word '"+ word+ "' cannot be longer than Crossword size\n"
                    document["error_msg"] <= (f"{msg}")
                    
                counter = counter+1            
            
            to_run = True
            
            for i in words:
                counter = 0
                duplicate = False
                first_appareance = False
                while counter != len(words):
                    if i == words[counter]:
                        if first_appareance == False:
                            first_appareance = True
                        else:
                            duplicate = True
                    counter += 1

                if duplicate == True:
                    msg = "Ops, the word '"+i+ "' appears to be used two or more times\n"
                    document["error_msg_dup"] <= (f"{msg}")
                    to_run = False
                    
                
            word_list = words

            #words are capitalized
            for i in range(len(words)):
                words[i] = words[i].upper()

            #words are sorted    
            
            
            if random_words_var:
                random.shuffle(words)
                words1 = words
            else:
                words1 = sorted(words, key=len,reverse=True)
            
            #takes the words definition input 
            counter = 1
            while counter != 21:
                word_def = ''
                id = 'word' + str(counter) +'def'

                #if field is empty the word input is used as word definition
                if document[id].value == '':
                    id = 'word' + str(counter) 
                    words_def.append(document[id].value)

                else:
                    words_def.append(document[id].value)
                    
                counter = counter+1

            #if there is more than one word the main function is called
            if len(words1) > 0 and to_run:
                def dolore():
                    print("main function called")
                    main(words1,how_many_crosswords)
                
                loading()
                timer.set_timeout(dolore, 500)
              
        def loading():
            
            word = "LOADING"
            first_word_coord = int(crossword_size/2)+crossword_size*int(crossword_size/2)-crossword_size 
            word_len = len(word)
            i_position = int(first_word_coord - (word_len/2)) 
            array = new_array()[0][0]
            array = place_horizzontally(word,i_position,array)
            
            counter = 0
            while counter != len(array):
                if array[counter] == '/' or array[counter] == '$':
                    array[counter] = ''
                counter = counter +1

            t = TABLE(cellspacing='0',border="2px")
            x = 0
            while x < crossword_size:
                y = 0
                while y < crossword_size:
                       
                    t <= TD(array[x*crossword_size+y],style={'height':32, 'width':32})   

                    y = y+1  
                t <= TR()   
                x = x +1 
               
            document['zone'].text = ''
            document['zone']<= t      

        #function that given an array prints it in the website console in a crossword form
        def print_array(given_array):        
            x = 0
            y = crossword_size

            while x != crossword_size*crossword_size:
                print(given_array[x:y])  #prints the first line of the crossword of lenght crossword_size
                x = x + crossword_size
                y = y + crossword_size
            print("\n")

        #function that places a given word in a crossword vertically
        #given the initial position of that word and the crossword
        #it should be placed in
        def place_vertically(word, i_position, given_array):  #iposition is the coordinate of the first letter in the word
            
            word_len = len(word)

            #if msg equals none at the end of the function the crossword is aborted
            msg = 0 

            #this is necessary so that the word isn't placed outside of the array
            if i_position + (word_len*crossword_size) <= crossword_size*crossword_size and i_position >= 0: 
                 
                letters = []
                for letter in word:
                    letters.append(letter)  #all the letters of the word are appended to an array

                counter = 0    
                while counter != word_len : 
                    #the letter is placed only if there is an empty space
                    if  given_array[i_position] == letters[counter] or given_array[i_position] == '/':  
                         
                        #the letter is placed 
                        given_array[i_position] = letters[counter]    
                        i_position = i_position + crossword_size
                        
                    else:
                        msg = None
                        
                    counter = counter + 1


                if msg != None:
                    return given_array    

            if msg == None:    
                return msg

            #the msg thing is here to avoid errors and wrong made crosswords


        #function that places a given word in a crossword horizzontally
        #given the initial position of that word and the crossword
        #it should be placed in
        def place_horizzontally(word, i_position, given_array):   # i_position is the coordinate of the first letter in the word
            
            word_len = len(word) 
            
            #if msg equals none at the end of the function the crossword is aborted
            msg = 0 
            
            #this is necessary so that the word isn't placed outside of the array 
            #and so that the word isn't split in two lines
            if i_position + word_len - 1 <= (i_position // crossword_size) * crossword_size + crossword_size-1: 
               
                letters = []
                for letter in word:
                    letters.append(letter)    #all the letters of the word are appended to an array  
                
                counter = 0  
                while counter != word_len :  

                    #the letter is placed only if there is an empty space
                    if  given_array[i_position] == letters[counter] or given_array[i_position] == '/':

                        #the letter is placed 
                        given_array[i_position] = letters[counter]   
                        i_position = i_position + 1
                        
                    else:
                        msg = None
                        
                    counter = counter + 1

                if msg != None:
                    return given_array   

            if msg == None:    
                return msg

            #the msg thing is here to avoid errors and wrong made crosswords    
        
        #a completely unoptimized function that searches where
        #there are similar letters given a word and a crossword
        def find_same_letters(array,word): 
            
            same_letters = []

            letters = []
            for letter in word:
                letters.append(letter)     
            
            letters_len = len(letters)
            counter = 0
            array_counter = 0

            #brute searches similarities
            while counter != letters_len:   
                while array_counter != crossword_size*crossword_size-1:

                    #if similarity is found
                    if letters[counter] == array[array_counter]:

                        #the infomation is defined with an array
                        #['letter of the word','where is that letter equal','position of that letter in the word']
                        same_letters.append([letters[counter], array_counter, counter ])

                    array_counter = array_counter + 1    
                counter = counter + 1 
                array_counter = 0
            
            return same_letters 

        # function that places the first word in an empty array
        def first_word_place(array,word,all_words):
            
            global words

            # used to calculate the center of a crosswords with a given lenght
            first_word_coord = int(crossword_size/2)+crossword_size*int(crossword_size/2)-crossword_size 
            word_len = len(word)
            i_position = int(first_word_coord - (word_len/2)) 
             
            # the word is placed horizzontaly in the 'center' of the crossword
            array = place_horizzontally(word,i_position,array)
            
            # this is a thing that places symbols before and after the word if it's possible
            # and if it doesn't break any crossword rule like going to the next line or 
            # outside the array. This part is necessary to avoid wrong made crosswords
            try:
                if (i_position // crossword_size) * crossword_size != i_position:
                    array[i_position-1] = '$'

                if (i_position // crossword_size) * crossword_size + crossword_size-1 != i_position + len(word)-1:  
                    array[i_position+len(word)] = '$'
            
            except Exception:
                pass
            
            # exeption handling in case of error 
            if array != 'none' and array != None:   

                # coords is where and how the word is placed
                # in this case is ['position of the word in the list of given words at the beginning',
                # 'position in the array of the first letter of the word','horizzontal or vertical,]

                coords = [words.index(word)+1,i_position,"hrz"] 
                return [array,[coords]]
                
        
        # This is the main core that binds together all the other functions to create a finished product
        # It creates all the possible crosswords with the given words and a given crossword size
        # To do this it creates all the possible permutation with the given words and then tries to place 
        # them in all the possible ways one by one
        # When how_many_crosswords isn't infinite this function creates a user wanted number of crosswords
        # It works in a recursive way, it places the first word, sees for example that the next word can
        # be placed in two different ways and it places it, now there are two crossword in which the next
        # word can be placed in and so on
        # When the last word of a permutation of words is placed in the crossword, that crossword become a 
        # finished one and it's appended to the end_crosswords array and then prompted at the end to the user
        # During all this procedure the place where the words are placed is also saved with the crossword
        # in the variable usually called coords
        def main(all_words,how_many_crosswords):       

            #global variables imported
            global words
            global permutation

            #variables are initialized
            similarity_tot = 0
            similarity_loop_counter = 0
            permutation_tot_counter = 0
            end_crosswords_counter = 0
            similarity_tot = 0
            similarity_loop_counter = 0
            end_crosswords_counter = 0

            words_len = len(all_words)          

            #permutations are created one by one
            permutations = itertools.permutations(all_words)
            
            #if set to true the process is aborted
            to_break = False

            #for every permutation created with the given words
            for permutation in permutations:
                print('Permutation used: '+str(permutation))
                permutation_tot_counter +=1
                #a new crossword bone structure is created 
                temp_crosswords = new_array()
                
                #the empty crossword is taken
                empty_crossword = temp_crosswords[0][0].copy()

                #the first word of the permutation is placed in the empty array
                first_array = first_word_place(empty_crossword, permutation[0],all_words)

                if len(first_array) == 1:
                    first_array.append([])

                #the first crossword with only one word in it is appended to the temp_crosswords array
                temp_crosswords[1].append(first_array)

                words_counter = 1
                #for every word in the permutation
                while words_counter != words_len  :  

                    #how many crosswords were created with the previous word of the permutation
                    last_created_crosswords_len = len(temp_crosswords[words_counter])   
                    
                    last_created_crossword = 0

                    #this part limits the amount of words placing that can be done
                    #thats because if the words are too many the possible ways one
                    #word can be placed becomes too big, for example if in the first crossword
                    #i have one word, then I place the next one in two possible ways, the next
                    #one in 4 possible ways, the next one in 12 and so on there is an overflow.
                    #The problem can beclearly seen if the words are too many, so a limit of possible placements
                    #is implemented. If it's value is low it will find a crossword faster if there
                    #are a lot of words, but there is a chance that with few words any crossword is found.
                    how_many_last_created_crossword_cycles = 0
                    if last_created_crosswords_len <= 10:
                        how_many_last_created_crossword_cycles = last_created_crosswords_len
                    else:
                        how_many_last_created_crossword_cycles = 10

                    #for every crossword created with the previous word
                    while last_created_crossword != how_many_last_created_crossword_cycles:    
                            
                        similarity_loop_counter = similarity_loop_counter + 1

                        #similarities between the word that needs to be placed and the crossword are searched
                        similarity = find_same_letters(temp_crosswords[words_counter][last_created_crossword][0], permutation[words_counter])

                        similarity_len = len(similarity)

                        similarity_tot = similarity_tot + similarity_len

                        similarity_element = 0  
                        #for every similarity between the word and the crossword
                        while  similarity_element != similarity_len :
                            
                            temp_array0 = 0

                            #a copy of various arrays is made
                            temp_array_vrt = temp_crosswords[words_counter][last_created_crossword][0].copy()    
                            temp_array_hrz = temp_crosswords[words_counter][last_created_crossword][0].copy()               
                            temp_array0 = temp_crosswords[words_counter][last_created_crossword][0].copy()              

                            #the coordinates of where the words were placed in crossword
                            #created with the previous word are copied
                            where = temp_crosswords[words_counter][last_created_crossword][1].copy()
                           
                            #if set to true the function is aborted
                            to_discard = False
                            word_orientation = 0
                            
                            #coordinates for the word to fit in the crossword are calculated
                            #both to be placed vertically and horizzontally
                            coords_vrt = similarity[similarity_element][1] - crossword_size * similarity[similarity_element][2]  
                            coords_hrz = similarity[similarity_element][1] - similarity[similarity_element][2]
                            
                            space_in_beetween_words = False
                            #this part checks if around the letter in the crossword in which the word needs
                            #to be placed has at has empty cells at it's corners, for example :
                            #    ///                           //g
                            #    aaa the corners are empty     aaa the corners are not empty and if a word is placed 
                            #    ///                           /// vertically the crossword will be wrong
                            if similarity[similarity_element][1] <= crossword_size*crossword_size-2-crossword_size and similarity[similarity_element][1] >= crossword_size+1:
                                if temp_array0[similarity[similarity_element][1]+crossword_size+1] == '/'and temp_array0[similarity[similarity_element][1]+crossword_size-1] == '/' and temp_array0[similarity[similarity_element][1]-crossword_size-1] == '/'and temp_array0[similarity[similarity_element][1]-crossword_size+1] == '/':
                                    space_in_beetween_words = True
                        
                            #this part checks if around the letter in the crossword in which the word needs
                            #to be placed has at has empty cells at it's corners, for example :
                            #    ///                           //g
                            #    aaa the corners are empty     aaa the corners are not empty and if a word is placed 
                            #    ///                           /// vertically the crossword will be wrong
                            
                            place_vertically_data = place_vertically(permutation[words_counter], coords_vrt, temp_array_vrt)
                            place_horizzontally_data =  place_horizzontally(permutation[words_counter], coords_hrz, temp_array_hrz)
                            if place_vertically_data != None and space_in_beetween_words == True:  
                                word_orientation = 'vrt'
                                #the word is placed vertically
                                temp_array = place_vertically_data
                               
                                #if after or before the word there is a letter from another word
                                try:
                                    if temp_array[coords_vrt-crossword_size].isalpha()==True or temp_array[coords_vrt+(len(permutation[words_counter]))*crossword_size].isalpha()==True:
                                        to_discard = True
                                        
                                except Exception:
                                    pass
                                
                                #if possible a placeholder '$' is placed before the word
                                try:
                                    if temp_array[coords_vrt-crossword_size] == '/' and coords_vrt>crossword_size-1:
                                        temp_array[coords_vrt-crossword_size] = '$'

                                except Exception:
                                    pass
                                
                                #if possible a placeholder '$' is placed after the word
                                try:
                                    if temp_array[coords_vrt+(len(permutation[words_counter]))*crossword_size]  == '/':

                                        temp_array[coords_vrt+(len(permutation[words_counter]))*crossword_size] = '$'

                                except Exception:
                                    pass

                            #checks if the word can be placed horizzontally
                            elif place_horizzontally_data != None and space_in_beetween_words == True:
                                word_orientation = 'hrz'
                                
                                #the word is placed 
                                temp_array = place_horizzontally_data #piazza la parola in una copia dell'array originale  
                                
                                #if after or before the word there is a letter from another word
                                try:
                                    if (coords_hrz // crossword_size) * crossword_size != coords_hrz and temp_array[coords_hrz-1].isalpha() == True or temp_array[coords_hrz+len(permutation[words_counter])].isalpha()==True: 
                                        to_discard = True
                                
                                except Exception:
                                    pass
                                
                                #if possible a placeholder '$' is placed before the word
                                try: 
                                    if (coords_hrz // crossword_size) * crossword_size != coords_hrz and temp_array[coords_hrz-1] == '/':
                                        temp_array[coords_hrz-1] = '$'
                                
                                except Exception:
                                    pass
                                
                                #if possible a placeholder '$' is placed after the word
                                try:
                                    if (coords_hrz // crossword_size) * crossword_size + crossword_size-1 != coords_hrz + len(permutation[words_counter])-1 and temp_array[coords_hrz+len(permutation[words_counter])] == '/':  
                                        temp_array[coords_hrz+len(permutation[words_counter])] = '$'

                                except Exception:
                                    pass
                            else:
                                to_discard = True
   
                            if word_orientation == 'hrz':
                                    coords = coords_hrz
                            elif word_orientation == 'vrt':
                                coords = coords_vrt    
                            else:
                                to_discard = True

                            if to_discard == False:
                               
                                #creates the coords info to be appended to the array
                                where_this_word = [words.index(permutation[words_counter])+1,coords,word_orientation]
                                
                                where.append(where_this_word)

                                to_append = [temp_array,where]

                                #if no errors occur the crossword is appended and the cycle is repeated
                                if temp_array != 'None' and temp_array != None:
                                    try:
                                        temp_crosswords[words_counter+1].append(to_append)
                                    except:
                                        Pass    
                            similarity_element = similarity_element + 1

                        last_created_crossword = last_created_crossword + 1

                    words_counter = words_counter + 1

                permutation_tot_counter = permutation_tot_counter + 1

                #this part checks if all the words of the permutation
                #have been placed 
                crosswords_len = 0
                for i in temp_crosswords:
                    if i != []:
                        crosswords_len = crosswords_len + 1

                if crosswords_len == len(permutation) + 1:
                    counter = 0
                    while counter != crosswords_len + 1:
                        
                        if to_break == True:
                            break

                        #finished crosswords are appended to the end_crosswords
                        #array, this part is stopped when the limit determined
                        #by how_many_crosswords is reached
                        if temp_crosswords[counter] == []:
                            for crossword in temp_crosswords[counter-1]:       
                                end_crosswords.append(crossword)
                                end_crosswords_counter = end_crosswords_counter + 1
                                if end_crosswords_counter >= how_many_crosswords:
                                    to_break = True
                                    print("Internal crosswords: "+str(len(temp_crosswords)))
                                    break 
                        counter = counter + 1

                if to_break == True:
                    break

            #finished crosswords are sent to be printed to the user
            sort_crosswords()
        
        #prints the words definitions
        #at the end of the site
        def print_word_def_site(coords):
            
            global words_def
            vertical_coords = []
            horizzontal_coords = []
            
            #coords are divided between vertical and horizzontal
            counter = 0
            while counter != len(coords):
                if coords[counter][2] == 'vrt':
                    vertical_coords.append(coords[counter])
                else:
                    horizzontal_coords.append(coords[counter])
                counter += 1

            #message created
            vertical_def = ''
            counter = 0
            while counter != len(vertical_coords):
                index = vertical_coords[counter][0]
                vertical_def = vertical_def + str(index) +")\n"+ words_def[index-1] + '\n'
                counter += 1
            
            
            #message created
            horizzontal_def = ''
            counter = 0
            while counter != len(horizzontal_coords):
                index = horizzontal_coords[counter][0]
                horizzontal_def = horizzontal_def + str(index) +")\n"+ words_def[index-1] + '\n'
                counter += 1

            #messages parsed to fields
            document["vrt"].clear()
            document["hrz"].clear()
            document["vrt"] <= (f"{vertical_def}")
            document["hrz"] <= (f"{horizzontal_def}")
        
        #intermediare function that prints the crossword on the website
        def sort_crosswords(): 
            print_array_site(end_crosswords[crosswors_list_index])
            
        #event if button previous is pressed
        def previous(event):
            global crosswors_list_index 
            if  crosswors_list_index > 0:
                #value is decreased 
                crosswors_list_index = crosswors_list_index -1
            sort_crosswords()

        #event if the button next is pressed
        def next(event):
            global crosswors_list_index
            if crosswors_list_index < len(end_crosswords)-1:
                #value is increased
                crosswors_list_index = crosswors_list_index +1
            sort_crosswords()
        
        #event if show words tick is ticked
        def show_words(event):
            global show_words_var

            #if true set to False
            #if false set to True
            if show_words_var:
                show_words_var = False
            else:
                show_words_var = True
            sort_crosswords()
        
        def random_tick(event):
            global random_words_var

            #if true set to False
            #if false set to True
            if random_words_var:
                random_words_var = False
            else:
                random_words_var = True
            

        #CONFIGS
        end_crosswords = []
        end_crosswords_counter = 0
        crosswors_list_index = 0
        word_list = []
        show_words_var = True
        random_words_var = False
        permutation = 0
        words = 0
        words_def = 0
        reload = False
        crossword_size = 10
        
        #prints an empty crossword if page is loaded or reloaded
        if reload == False:
            array = new_array()
            array = array[0][0]

            counter = 0
            while counter != len(array):
                array[counter] = ''
                counter += 1

            t = TABLE(cellspacing='0',border="2px")
            x = 0
            while x < crossword_size:
                y = 0
                while y < crossword_size:
                       
                    t <= TD(array[x*crossword_size+y],style={'height':30, 'width':30})   

                    y = y+1  
                
                t <= TR()   
                x = x +1 
               
            document['zone'].text = ''
            document['zone']<= t      

        #binds html to python events
        document['submit'].bind('click',submit)
        document['previous'].bind('click',previous)
        document['next'].bind('click',next)
        document['show_words'].bind('click',show_words)
        document['random_tick'].bind('click',random_tick)
        
        #the end
    </script>
    
    </body>
    
    </html>